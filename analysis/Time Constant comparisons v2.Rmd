---
title: "Time Constant comparisons"
author: "Nick Coronato"
date: "7/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries, include = FALSE}
# Call the appropriate libraries.
library(tidyverse)
library(plotrix)
library(dplyr)
library(plyr)
```

# Data preparation

```{r Read in data, message = FALSE, include = FALSE}
# here::i_am("analysis/Time Constant comparisons v2.Rmd")
# library(here)
# 
# # Get the files names
# files <-  list.files(path = '/data/',pattern="*.csv")
# files
# 
# readr::read_csv(
#   here("","*.csv"),
#   col_types = list(.default = readr::col_guess()),
# )
# 
# # First apply read.csv, then rbind
# myfiles  <-  do.call(rbind, lapply(files, function(x) read.csv(x, stringsAsFactors = FALSE)))
```



```{r}
#read in the predicted data
```


### Function to compute mean and standard error for each group.

```{r SummarySE function}
## Summarizes data.
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
```

## Read in csv
Read in csv files for predicted points (from MixedEffectsCPETmodels.Rmd) and Tau values (separate .csv files).
```{r, message = FALSE}
here::i_am("analysis/Time Constant comparisons v2.Rmd")
library(here)

dat.HRon <- readr::read_csv(
  here("output","dat.HRon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.HRoff <- readr::read_csv(
  here("output","dat.HRoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.RQon <- readr::read_csv(
  here("output","dat.RQon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.RQoff <- readr::read_csv(
  here("output","dat.RQoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.RRon <- readr::read_csv(
  here("output","dat.RRon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.RRoff <- readr::read_csv(
  here("output","dat.RRoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.VCO2on <- readr::read_csv(
  here("output","dat.VCO2kglbmon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.VCO2off <- readr::read_csv(
  here("output","dat.VCO2kglbmoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.VO2off <- readr::read_csv(
  here("output","dat.VO2KGLBMoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.VO2on <- readr::read_csv(
  here("output","dat.VO2KGLBMon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))

dat.VEoff <- readr::read_csv(
  here("output","dat.VEkglbmoff.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
dat.VEon <- readr::read_csv(
  here("output","dat.VEkglbmon.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
```

```{r, message = FALSE}
here::i_am("analysis/Time Constant comparisons v2.Rmd")
library(here)

HR_on_tau <- readr::read_csv(
  here("data","avg_HR_on.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
HR_off_tau <- readr::read_csv(
  here("data","avg_HR_off.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
# tau.RQon <- readr::read_csv(
#   here("data","avg_RQ_on.csv"
#        # ,
#   # col_types = list(.default = readr::col_guess())
# ))
# tau.RQoff <- readr::read_csv(
#   here("data","avg_RQ_off.csv"
#        # ,
#   # col_types = list(.default = readr::col_guess())
# ))
RR_on_tau <- readr::read_csv(
  here("data","avg_RR_on.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
RR_off_tau <- readr::read_csv(
  here("data","avg_RR_off.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
VCO2_on_tau <- readr::read_csv(
  here("data","avg_VCO2_on.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
VCO2_off_tau <- readr::read_csv(
  here("data","avg_VCO2_off.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
VO2_off_tau <- readr::read_csv(
  here("data","avg_VO2_off.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
VO2_on_tau <- readr::read_csv(
  here("data","avg_VO2_on.csv"
))

VE_on_tau <- readr::read_csv(
  here("data","avg_VE_on.csv"
       # ,
  # col_types = list(.default = readr::col_guess())
))
VE_off_tau <- readr::read_csv(
  here("data","avg_VE_off.csv"
))


```

#VCO2 on
Rearrange the data into long format, with mean and standard error calculations for each group (GenderxTannerxIntensity).
```{r}
CPET <- "VCO2_on_"

# VCO2_on <- filter(myfiles, set == "VCO2_on")

bout1 <- summarySE(VCO2_on_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VCO2_on_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VCO2_on_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VCO2_on_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VCO2_on_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VCO2_on_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VCO2_on_tau)[2] <- "group"

```



Combine the dataframes for predicted points (regression model) and Tau values (exponential model).

```{r}
# combine the two DFs
library(dplyr)
new.dat.VCO2.on <- filter(dat.VCO2on, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VCO2.on)[1] <- "bout"
# names(new.dat.VCO2.on)[2] <- "value"
new.dat.VCO2.on <- new.dat.VCO2.on[,c(6,7,8,1,2,3)]
names(new.dat.VCO2.on)[1:3] <- c("group","facet","panel")

new.dat.VCO2.on <- arrange(new.dat.VCO2.on,bout,group,facet,panel)

VCO2_on_tau <- arrange(VCO2_on_tau,bout,group,facet,panel)
VCO2_on_tau <- mutate(VCO2_on_tau, bout = as.numeric(bout))

combined.VCO2.on <- tibble(new.dat.VCO2.on[,1:6],VCO2_on_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VCO2.on <- split(combined.VCO2.on, with(combined.VCO2.on, interaction(group,facet,panel)), drop = TRUE)

split.VCO2.on[[1]] -> FEMALE.early.high
split.VCO2.on[[5]] -> FEMALE.early.low
split.VCO2.on[[3]] -> FEMALE.late.high
split.VCO2.on[[7]] -> FEMALE.late.low

split.VCO2.on[[2]] -> MALE.early.high
split.VCO2.on[[6]] -> MALE.early.low
split.VCO2.on[[4]] -> MALE.late.high
split.VCO2.on[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.

## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg"))
       , width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 on-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#VCO2 off
```{r}
CPET <- "VCO2_off_"

# VCO2_off <- filter(myfiles, set == "VCO2_off")

bout1 <- summarySE(VCO2_off_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VCO2_off_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VCO2_off_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VCO2_off_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VCO2_off_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VCO2_off_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VCO2_off_tau)[2] <- "group"

```

Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.VCO2.off <- filter(dat.VCO2off, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VCO2.off)[1] <- "bout"
# names(new.dat.VCO2.off)[2] <- "value"
new.dat.VCO2.off <- new.dat.VCO2.off[,c(6,7,8,1,2,3)]
names(new.dat.VCO2.off)[1:3] <- c("group","facet","panel")

new.dat.VCO2.off <- arrange(new.dat.VCO2.off,bout,group,facet,panel)

VCO2_off_tau <- arrange(VCO2_off_tau,bout,group,facet,panel)
VCO2_off_tau <- mutate(VCO2_off_tau, bout = as.numeric(bout))

combined.VCO2.off <- tibble(new.dat.VCO2.off[,1:6],VCO2_off_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VCO2.off <- split(combined.VCO2.off, with(combined.VCO2.off, interaction(group,facet,panel)), drop = TRUE)

split.VCO2.off[[1]] -> FEMALE.early.high
split.VCO2.off[[5]] -> FEMALE.early.low
split.VCO2.off[[3]] -> FEMALE.late.high
split.VCO2.off[[7]] -> FEMALE.late.low

split.VCO2.off[[2]] -> MALE.early.high
split.VCO2.off[[6]] -> MALE.early.low
split.VCO2.off[[4]] -> MALE.late.high
split.VCO2.off[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.


## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Late Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VCO2 off-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VCO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VCO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#HR on
Rearrange the data into long format, with mean and standard error calculations for each group (GenderxTannerxIntensity).
```{r}
CPET <- "HR_on_"

# HR_on <- filter(myfiles, set == "HR_on")

bout1 <- summarySE(HR_on_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(HR_on_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(HR_on_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(HR_on_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(HR_on_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

HR_on_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(HR_on_tau)[2] <- "group"

```

Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.HR.on <- filter(dat.HRon, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
names(new.dat.HR.on)[1] <- "bout"
new.dat.HR.on <- mutate(new.dat.HR.on, bout = as.numeric(bout))
  

# names(new.dat.HR.on)[2] <- "value"
new.dat.HR.on <- new.dat.HR.on[,c(6,7,8,1,2,3)]
names(new.dat.HR.on)[1:3] <- c("group","facet","panel")

new.dat.HR.on <- arrange(new.dat.HR.on,bout,group,facet,panel)


HR_on_tau <- arrange(HR_on_tau,bout,group,facet,panel)
HR_on_tau <- mutate(HR_on_tau, bout = as.numeric(bout))

combined.HR.on <- tibble(new.dat.HR.on[,1:6],HR_on_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.HR.on <- split(combined.HR.on, with(combined.HR.on, interaction(group,facet,panel)), drop = TRUE)

split.HR.on[[1]] -> FEMALE.early.high
split.HR.on[[5]] -> FEMALE.early.low
split.HR.on[[3]] -> FEMALE.late.high
split.HR.on[[7]] -> FEMALE.late.low

split.HR.on[[2]] -> MALE.early.high
split.HR.on[[6]] -> MALE.early.low
split.HR.on[[4]] -> MALE.late.high
split.HR.on[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.

## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)
## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR on-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#HR off
```{r}
CPET <- "HR_off_"

# HR_off <- filter(myfiles, set == "HR_off")

bout1 <- summarySE(HR_off_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(HR_off_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(HR_off_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(HR_off_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(HR_off_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

HR_off_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(HR_off_tau)[2] <- "group"

```

Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.HR.off <- filter(dat.HRoff, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
names(new.dat.HR.off)[1] <- "bout"
new.dat.HR.off <- mutate(new.dat.HR.off, bout = as.numeric(bout))
  

# names(new.dat.HR.off)[2] <- "value"
new.dat.HR.off <- new.dat.HR.off[,c(6,7,8,1,2,3)]
names(new.dat.HR.off)[1:3] <- c("group","facet","panel")

new.dat.HR.off <- arrange(new.dat.HR.off,bout,group,facet,panel)


HR_off_tau <- arrange(HR_off_tau,bout,group,facet,panel)
HR_off_tau <- mutate(HR_off_tau, bout = as.numeric(bout))

combined.HR.off <- tibble(new.dat.HR.off[,1:6],HR_off_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.HR.off <- split(combined.HR.off, with(combined.HR.off, interaction(group,facet,panel)), drop = TRUE)

split.HR.off[[1]] -> FEMALE.early.high
split.HR.off[[5]] -> FEMALE.early.low
split.HR.off[[3]] -> FEMALE.late.high
split.HR.off[[7]] -> FEMALE.late.low

split.HR.off[[2]] -> MALE.early.high
split.HR.off[[6]] -> MALE.early.low
split.HR.off[[4]] -> MALE.late.high
split.HR.off[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.


## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Late Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="HR off-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean HR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean HR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#RR on
Rearrange the data into long format, with mean and standard error calculations for each group (GenderxTannerxIntensity).
```{r}
CPET <- "RR_on_"

# RR_on <- filter(myfiles, set == "RR_on")

bout1 <- summarySE(RR_on_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(RR_on_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(RR_on_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(RR_on_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(RR_on_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

RR_on_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(RR_on_tau)[2] <- "group"

```

Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.RR.on <- filter(dat.RRon, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.RR.on)[1] <- "bout"
# names(new.dat.RR.on)[2] <- "value"
new.dat.RR.on <- new.dat.RR.on[,c(6,7,8,1,2,3)]
names(new.dat.RR.on)[1:3] <- c("group","facet","panel")

new.dat.RR.on <- arrange(new.dat.RR.on,bout,group,facet,panel)

RR_on_tau <- arrange(RR_on_tau,bout,group,facet,panel)
RR_on_tau <- mutate(RR_on_tau, bout = as.numeric(bout))

combined.RR.on <- tibble(new.dat.RR.on[,1:6],RR_on_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.RR.on <- split(combined.RR.on, with(combined.RR.on, interaction(group,facet,panel)), drop = TRUE)

split.RR.on[[1]] -> FEMALE.early.high
split.RR.on[[5]] -> FEMALE.early.low
split.RR.on[[3]] -> FEMALE.late.high
split.RR.on[[7]] -> FEMALE.late.low

split.RR.on[[2]] -> MALE.early.high
split.RR.on[[6]] -> MALE.early.low
split.RR.on[[4]] -> MALE.late.high
split.RR.on[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.

## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR on-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#RR off
```{r}
CPET <- "RR_off_"

# RR_off <- filter(myfiles, set == "RR_off")

bout1 <- summarySE(RR_off_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(RR_off_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(RR_off_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(RR_off_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(RR_off_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

RR_off_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(RR_off_tau)[2] <- "group"

```
Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.RR.off <- filter(dat.RRoff, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.RR.off)[1] <- "bout"
# names(new.dat.RR.off)[2] <- "value"
new.dat.RR.off <- new.dat.RR.off[,c(6,7,8,1,2,3)]
names(new.dat.RR.off)[1:3] <- c("group","facet","panel")

new.dat.RR.off <- arrange(new.dat.RR.off,bout,group,facet,panel)

RR_off_tau <- arrange(RR_off_tau,bout,group,facet,panel)
RR_off_tau <- mutate(RR_off_tau, bout = as.numeric(bout))

combined.RR.off <- tibble(new.dat.RR.off[,1:6],RR_off_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.RR.off <- split(combined.RR.off, with(combined.RR.off, interaction(group,facet,panel)), drop = TRUE)

split.RR.off[[1]] -> FEMALE.early.high
split.RR.off[[5]] -> FEMALE.early.low
split.RR.off[[3]] -> FEMALE.late.high
split.RR.off[[7]] -> FEMALE.late.low

split.RR.off[[2]] -> MALE.early.high
split.RR.off[[6]] -> MALE.early.low
split.RR.off[[4]] -> MALE.late.high
split.RR.off[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.


## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
# Set the min and max values for the x- and y-axes in our plots.
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Late Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="RR off-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean RR",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean RR","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#VE on
Rearrange the data into long format, with mean and standard error calculations for each group (GenderxTannerxIntensity).
```{r}
CPET <- "VE_on_"

# VE_on <- filter(myfiles, set == "VE_on")

bout1 <- summarySE(VE_on_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VE_on_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VE_on_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VE_on_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VE_on_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VE_on_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VE_on_tau)[2] <- "group"

```
Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.VE.on <- filter(dat.VEon, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VE.on)[1] <- "bout"
# names(new.dat.VE.on)[2] <- "value"
new.dat.VE.on <- new.dat.VE.on[,c(6,7,8,1,2,3)]
names(new.dat.VE.on)[1:3] <- c("group","facet","panel")

new.dat.VE.on <- arrange(new.dat.VE.on,bout,group,facet,panel)

VE_on_tau <- arrange(VE_on_tau,bout,group,facet,panel)
VE_on_tau <- mutate(VE_on_tau, bout = as.numeric(bout))

combined.VE.on <- tibble(new.dat.VE.on[,1:6],VE_on_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VE.on <- split(combined.VE.on, with(combined.VE.on, interaction(group,facet,panel)), drop = TRUE)

split.VE.on[[1]] -> FEMALE.early.high
split.VE.on[[5]] -> FEMALE.early.low
split.VE.on[[3]] -> FEMALE.late.high
split.VE.on[[7]] -> FEMALE.late.low

split.VE.on[[2]] -> MALE.early.high
split.VE.on[[6]] -> MALE.early.low
split.VE.on[[4]] -> MALE.late.high
split.VE.on[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.

## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE on-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#VE off
```{r}
CPET <- "VE_off_"

# VE_off <- filter(myfiles, set == "VE_off")

bout1 <- summarySE(VE_off_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VE_off_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VE_off_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VE_off_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VE_off_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VE_off_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VE_off_tau)[2] <- "group"

```
Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.VE.off <- filter(dat.VEoff, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VE.off)[1] <- "bout"
# names(new.dat.VE.off)[2] <- "value"
new.dat.VE.off <- new.dat.VE.off[,c(6,7,8,1,2,3)]
names(new.dat.VE.off)[1:3] <- c("group","facet","panel")

new.dat.VE.off <- arrange(new.dat.VE.off,bout,group,facet,panel)

VE_off_tau <- arrange(VE_off_tau,bout,group,facet,panel)
VE_off_tau <- mutate(VE_off_tau, bout = as.numeric(bout))

combined.VE.off <- tibble(new.dat.VE.off[,1:6],VE_off_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VE.off <- split(combined.VE.off, with(combined.VE.off, interaction(group,facet,panel)), drop = TRUE)

split.VE.off[[1]] -> FEMALE.early.high
split.VE.off[[5]] -> FEMALE.early.low
split.VE.off[[3]] -> FEMALE.late.high
split.VE.off[[7]] -> FEMALE.late.low

split.VE.off[[2]] -> MALE.early.high
split.VE.off[[6]] -> MALE.early.low
split.VE.off[[4]] -> MALE.late.high
split.VE.off[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.


## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Late Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VE off-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VE",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VE","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#VO2 on
Rearrange the data into long format, with mean and standard error calculations for each group (GenderxTannerxIntensity).
```{r}
CPET <- "VO2_on_"

# VO2_on <- filter(myfiles, set == "VO2_on")

bout1 <- summarySE(VO2_on_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VO2_on_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VO2_on_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VO2_on_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VO2_on_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VO2_on_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VO2_on_tau)[2] <- "group"

```
Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.VO2.on <- filter(dat.VO2on, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VO2.on)[1] <- "bout"
# names(new.dat.VO2.on)[2] <- "value"
new.dat.VO2.on <- new.dat.VO2.on[,c(6,7,8,1,2,3)]
names(new.dat.VO2.on)[1:3] <- c("group","facet","panel")

new.dat.VO2.on <- arrange(new.dat.VO2.on,bout,group,facet,panel)

VO2_on_tau <- arrange(VO2_on_tau,bout,group,facet,panel)
VO2_on_tau <- mutate(VO2_on_tau, bout = as.numeric(bout))

combined.VO2.on <- tibble(new.dat.VO2.on[,1:6],VO2_on_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VO2.on <- split(combined.VO2.on, with(combined.VO2.on, interaction(group,facet,panel)), drop = TRUE)

split.VO2.on[[1]] -> FEMALE.early.high
split.VO2.on[[5]] -> FEMALE.early.low
split.VO2.on[[3]] -> FEMALE.late.high
split.VO2.on[[7]] -> FEMALE.late.low

split.VO2.on[[2]] -> MALE.early.high
split.VO2.on[[6]] -> MALE.early.low
split.VO2.on[[4]] -> MALE.late.high
split.VO2.on[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.

## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 on-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

#VO2 off
```{r}
CPET <- "VO2_off_"

# VO2_off <- filter(myfiles, set == "VO2_off")

bout1 <- summarySE(VO2_off_tau, measurevar="bout1", groupvars = c("group",'facet','panel'))
bout1 <- bout1[,c(1,2,3,5,7)] 
# %>% mutate(bout = 1)
names(bout1)[4] <- "value"

bout2 <- summarySE(VO2_off_tau, measurevar="bout2", groupvars = c("group",'facet','panel'))
bout2 <- bout2[,c(1,2,3,5,7)]
# %>% mutate(bout = 2)
names(bout2)[4] <- "value"

bout3 <- summarySE(VO2_off_tau, measurevar="bout3", groupvars = c("group",'facet','panel'))
bout3 <- bout3[,c(1,2,3,5,7)]
# %>% mutate(bout = 3)
names(bout3)[4] <- "value"

bout4 <- summarySE(VO2_off_tau, measurevar="bout4", groupvars = c("group",'facet','panel'))
bout4 <- bout4[,c(1,2,3,5,7)]
# %>% mutate(bout = 4)
names(bout4)[4] <- "value"

bout5 <- summarySE(VO2_off_tau, measurevar="bout5", groupvars = c("group",'facet','panel'))
bout5 <- bout5[,c(1,2,3,5,7)]
# %>% mutate(bout = 5)
names(bout5)[4] <- "value"

VO2_off_tau <- bind_rows(list(bout1, bout2, bout3, bout4, bout5), .id="bout") 
names(VO2_off_tau)[2] <- "group"

```
Combine the dataframes for predicted points (regression model) and Tau values (exponential model).
```{r}
# combine the two DFs
library(dplyr)
new.dat.VO2.off <- filter(dat.VO2off, x != 0
                          # , group %in% 'FEMALE', facet%in% "Early", panel%in% "high"
                          )
  
names(new.dat.VO2.off)[1] <- "bout"
# names(new.dat.VO2.off)[2] <- "value"
new.dat.VO2.off <- new.dat.VO2.off[,c(6,7,8,1,2,3)]
names(new.dat.VO2.off)[1:3] <- c("group","facet","panel")

new.dat.VO2.off <- arrange(new.dat.VO2.off,bout,group,facet,panel)

VO2_off_tau <- arrange(VO2_off_tau,bout,group,facet,panel)
VO2_off_tau <- mutate(VO2_off_tau, bout = as.numeric(bout))

combined.VO2.off <- tibble(new.dat.VO2.off[,1:6],VO2_off_tau[,5:6])
```


Separate the combined DF into each group (Gender x Tanner x Intensity).
```{r}
split.VO2.off <- split(combined.VO2.off, with(combined.VO2.off, interaction(group,facet,panel)), drop = TRUE)

split.VO2.off[[1]] -> FEMALE.early.high
split.VO2.off[[5]] -> FEMALE.early.low
split.VO2.off[[3]] -> FEMALE.late.high
split.VO2.off[[7]] -> FEMALE.late.low

split.VO2.off[[2]] -> MALE.early.high
split.VO2.off[[6]] -> MALE.early.low
split.VO2.off[[4]] -> MALE.late.high
split.VO2.off[[8]] -> MALE.late.low
```

The eight code chunks below generate a separate plot for each subject group.


## Female Early High
```{r}
grouping <- "FEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.high$predicted)-max(FEMALE.early.high$std.error))
maxyleft <- 1.1*(max(FEMALE.early.high$predicted)+max(FEMALE.early.high$std.error))
minyright <- .9*(min(FEMALE.early.high$value)-max(FEMALE.early.high$se))
maxyright <-1.1*(max(FEMALE.early.high$value)+max(FEMALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.high$bout, FEMALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Early Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$predicted+(FEMALE.early.high$std.error), y1=FEMALE.early.high$predicted-(FEMALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.high$bout, y=FEMALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.high$bout, y0=FEMALE.early.high$value+(FEMALE.early.high$se), y1=FEMALE.early.high$value-(FEMALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Early Low
```{r}
grouping <- "FEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.early.low$predicted)-max(FEMALE.early.low$std.error))
maxyleft <- 1.1*(max(FEMALE.early.low$predicted)+max(FEMALE.early.low$std.error))
minyright <- .9*(min(FEMALE.early.low$value)-max(FEMALE.early.low$se))
maxyright <-1.1*(max(FEMALE.early.low$value)+max(FEMALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.early.low$bout, FEMALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Early Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$predicted+(FEMALE.early.low$std.error), y1=FEMALE.early.low$predicted-(FEMALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.early.low$bout, y=FEMALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.early.low$bout, y0=FEMALE.early.low$value+(FEMALE.early.low$se), y1=FEMALE.early.low$value-(FEMALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late Low
```{r}
grouping <- "FLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.low$predicted)-max(FEMALE.late.low$std.error))
maxyleft <- 1.1*(max(FEMALE.late.low$predicted)+max(FEMALE.late.low$std.error))
minyright <- .9*(min(FEMALE.late.low$value)-max(FEMALE.late.low$se))
maxyright <-1.1*(max(FEMALE.late.low$value)+max(FEMALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.low$bout, FEMALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Late Puberty Female, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$predicted+(FEMALE.late.low$std.error), y1=FEMALE.late.low$predicted-(FEMALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.low$bout, y=FEMALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.low$bout, y0=FEMALE.late.low$value+(FEMALE.late.low$se), y1=FEMALE.late.low$value-(FEMALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Female Late High
```{r}
grouping <- "FLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(FEMALE.late.high$predicted)-max(FEMALE.late.high$std.error))
maxyleft <- 1.1*(max(FEMALE.late.high$predicted)+max(FEMALE.late.high$std.error))
minyright <- .9*(min(FEMALE.late.high$value)-max(FEMALE.late.high$se))
maxyright <-1.1*(max(FEMALE.late.high$value)+max(FEMALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(FEMALE.late.high$bout, FEMALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Late Puberty Female, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$predicted+(FEMALE.late.high$std.error), y1=FEMALE.late.high$predicted-(FEMALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=FEMALE.late.high$bout, y=FEMALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(FEMALE.late.high$bout, y0=FEMALE.late.high$value+(FEMALE.late.high$se), y1=FEMALE.late.high$value-(FEMALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(FEMALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early High
```{r}
grouping <- "MEH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.high$predicted)-max(MALE.early.high$std.error))
maxyleft <- 1.1*(max(MALE.early.high$predicted)+max(MALE.early.high$std.error))
minyright <- .9*(min(MALE.early.high$value)-max(MALE.early.high$se))
maxyright <-1.1*(max(MALE.early.high$value)+max(MALE.early.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.high$bout, MALE.early.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Early Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.high$bout, y0=MALE.early.high$predicted+(MALE.early.high$std.error), y1=MALE.early.high$predicted-(MALE.early.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.high$bout, y=MALE.early.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.high$bout, y0=MALE.early.high$value+(MALE.early.high$se), y1=MALE.early.high$value-(MALE.early.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Early Low
```{r}
grouping <- "MEL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.early.low$predicted)-max(MALE.early.low$std.error))
maxyleft <- 1.1*(max(MALE.early.low$predicted)+max(MALE.early.low$std.error))
minyright <- .9*(min(MALE.early.low$value)-max(MALE.early.low$se))
maxyright <-1.1*(max(MALE.early.low$value)+max(MALE.early.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.early.low$bout, MALE.early.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Early Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.early.low$bout, y0=MALE.early.low$predicted+(MALE.early.low$std.error), y1=MALE.early.low$predicted-(MALE.early.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.early.low$bout, y=MALE.early.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.early.low$bout, y0=MALE.early.low$value+(MALE.early.low$se), y1=MALE.early.low$value-(MALE.early.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.early.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late Low
```{r}
grouping <- "MLL"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.low$predicted)-max(MALE.late.low$std.error))
maxyleft <- 1.1*(max(MALE.late.low$predicted)+max(MALE.late.low$std.error))
minyright <- .9*(min(MALE.late.low$value)-max(MALE.late.low$se))
maxyright <-1.1*(max(MALE.late.low$value)+max(MALE.late.low$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.low$bout, MALE.late.low$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Late Puberty Male, Low Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.low$bout, y0=MALE.late.low$predicted+(MALE.late.low$std.error), y1=MALE.late.low$predicted-(MALE.late.low$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.low$bout, y=MALE.late.low$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.low$bout, y0=MALE.late.low$value+(MALE.late.low$se), y1=MALE.late.low$value-(MALE.late.low$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.low$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```

## Male Late High
```{r}
grouping <- "MLH"

# Set the min and max values for the x- and y-axes in our plots.
minyleft <- .9*(min(MALE.late.high$predicted)-max(MALE.late.high$std.error))
maxyleft <- 1.1*(max(MALE.late.high$predicted)+max(MALE.late.high$std.error))
minyright <- .9*(min(MALE.late.high$value)-max(MALE.late.high$se))
maxyright <-1.1*(max(MALE.late.high$value)+max(MALE.late.high$se))

#save the plot
jpeg(file= here("output/plots",paste0(CPET,grouping,".jpeg")), width = 800, height = 500)

## add extra space to right margin of plot within frame
par(mar=c(5, 4, 4, 6) + 0.1)

## Plot first set of data and draw its axis
plot(MALE.late.high$bout, MALE.late.high$predicted, 
     xlim = c(0,5), ylim = c(minyleft,maxyleft)
   , pch=16, axes=FALSE, xlab="", ylab="",
   type="p",col="black", main="VO2 off-transient - Late Puberty Male, High Intensity"
      )

# axis generation
axis(2, ylim=c(0.02,.06), col="black", las=1)  ## las=1 makes horizontal labels
mtext("Mean VO2",side=2,line=3.2)
box()
# standard error bars for the predicted values
arrows(MALE.late.high$bout, y0=MALE.late.high$predicted+(MALE.late.high$std.error), y1=MALE.late.high$predicted-(MALE.late.high$std.error),
       length = 0.05, angle = 90, code = 3)

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(x=MALE.late.high$bout, y=MALE.late.high$value
     , pch=15,  xlab="", ylab="", ylim=c(minyright,maxyright), xlim = c(0,5),
    axes=FALSE, type="p", col="red" )
# standard error bars for the Tau values
arrows(MALE.late.high$bout, y0=MALE.late.high$value+(MALE.late.high$se), y1=MALE.late.high$value-(MALE.late.high$se),
       length = 0.05, angle = 90, code = 3, col="red")

## a little farther out (line=3) to make room for labels
mtext("Time Constant (tau)",side=4,col="red",line=3) 
axis(4, ylim=c(100,190), col="red",col.axis="red",las=1)

## Draw the time axis (bouts 1-5)
axis(1,pretty(range(MALE.late.high$bout),5))
mtext("Bout",side=1,col="black",line=2.5)  

## Add Legend
legend("topleft",legend=c("Predicted Mean VO2","Time Constant"),
  text.col=c("black","red"),pch=c(16,15),col=c("black","red"))

dev.off()
```
